{% extends 'base.html' %}
{% block content %}
<h2>All Snippets</h2>
<div class="snippets-list">
  {% for snippet in snippets %}
  <div class="snippet-card mb-4 p-3 border rounded">
    <h4>{{ snippet.title }}</h4>
    <p class="text-muted">{{ snippet.description }}</p>
    
    <div class="row">
      <div class="col-md-6">
        <h6>Code</h6>
        <pre class="snippet-code">{{ snippet.code }}</pre>
        <div class="mt-2">
          <button class="btn btn-sm btn-primary copy-btn" data-code="{{ snippet.code | e }}">Copy CSS</button>
        </div>
      </div>
      
      <div class="col-md-6">
        <h6>Live Preview</h6>
        <style>
          {{ snippet.preview_style() | safe }}
        </style>
        <div class="preview-box p-3">
          <!-- Apply CSS class name from snippet title or a 'class' field -->
          <div class="{{ snippet.title | lower | replace(' ', '-') }}">
            {{ snippet.title }} preview
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>

<script>
document.querySelectorAll('.copy-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const code = btn.getAttribute('data-code');
    navigator.clipboard.writeText(code).then(() => {
      alert('Copied to clipboard');
    });
  });
});
</script>
{% endblock %}
